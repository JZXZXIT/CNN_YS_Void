# 基于卷积神经网络识别与原神角色的声音相似度

使用了卷积神经网络，进行多分类任务。使用时请上传一份尽量干净的人声，模型将输出与声音最匹配的原神角色与相似度。  
使用人声进行相似度预测时很不准确，当个乐子玩玩即可。但是模型在预测原神角色声音时还是很准确的。

## 模块作用
mian.py 中保存了调用代码的一些基本操作  
My_Classes.py 中保存了两个类，一个是模型的训练和预测，一个是数据集的制作方法  
Mymodel.py 中保存了所需模型  
辅助库.py 中保存了一些可能会用到的功能

## 使用方法
因为Github的空间有限，无法上传数据集和我训练完的模型，所以需要各位自行准备数据集并训练模型  
b站有分享原神角色的纯声音，可以获取并用其制作数据集  
然后通过这些数据训练模型  
最后录制一段10s以上的纯人声，输入模型进行预测

## 实现过程
* 将音频文件以  步长为5s 窗口大小为10s  的规格划窗处理
* 将每个片段以  窗口大小为2048 步长为512 梅尔滤波器数量为128  的规格处理为梅尔频谱
* 将处理后的二维梅尔频谱裁切为  (128, 800)  的规格
* 增加两个空维度，处理为  (1, 3, 128, 800)  的规格
* 将数据在第一维度叠加，处理为  (n, 3, 128, 800)  的规格
* 打上标签，整理为一个数据集，打乱数据集
* 输入到网络中，定义网络参数，进行训练
* 进行预测

## 需要安装的库
torch  
numpy  
librosa  
pywt  
  
下面是辅助库中可能会用到的库  
soundfile  
pydub  
matplotlib